-- 古诗词赏析网站示例数据插入脚本
USE poem_app;

-- 插入诗词数据
INSERT INTO poems (title, poet_id, dynasty_id, content_type, content, full_content, analysis, theme, difficulty_level) VALUES
('静夜思', 1, 1, '诗', 
 '["床前明月光，疑是地上霜。", "举头望明月，低头思故乡。"]',
 '床前明月光，疑是地上霜。\n举头望明月，低头思故乡。',
 '这首诗写的是在寂静的月夜思念家乡的感受。诗的前两句，是写诗人在作客他乡的特定环境中一刹那间所产生的错觉。一个独处他乡的人，白天奔波忙碌，倒还能冲淡离愁，然而一到夜深人静的时候，心头就难免泛起阵阵思念故乡的波澜。',
 '思乡', '简单'),

('春晓', 3, 1, '诗',
 '["春眠不觉晓，处处闻啼鸟。", "夜来风雨声，花落知多少。"]',
 '春眠不觉晓，处处闻啼鸟。\n夜来风雨声，花落知多少。',
 '这首小诗初读似觉平淡无奇，反复读之，便觉诗中别有天地。它的艺术魅力不在于华丽的辞藻，不在于奇绝的艺术手法，而在于它的韵味。整首诗的风格就像行云流水一样平易自然，然而悠远深厚，独臻妙境。',
 '春天', '简单'),

('登鹳雀楼', 4, 1, '诗',
 '["白日依山尽，黄河入海流。", "欲穷千里目，更上一层楼。"]',
 '白日依山尽，黄河入海流。\n欲穷千里目，更上一层楼。',
 '这首诗写诗人在登高望远中表现出来的不凡的胸襟抱负，反映了盛唐时期人们积极向上的进取精神。前两句写所见，后两句写所感。',
 '励志', '中等'),

('相思', 5, 1, '诗',
 '["红豆生南国，春来发几枝。", "愿君多采撷，此物最相思。"]',
 '红豆生南国，春来发几枝。\n愿君多采撷，此物最相思。',
 '这是借咏物而寄相思的诗，是眷怀友人之作。全诗情调健美高雅，怀思饱满奔放，语言朴素无华，韵律和谐柔美。',
 '爱情', '简单'),

('江雪', 2, 1, '诗',
 '["千山鸟飞绝，万径人踪灭。", "孤舟蓑笠翁，独钓寒江雪。"]',
 '千山鸟飞绝，万径人踪灭。\n孤舟蓑笠翁，独钓寒江雪。',
 '这首诗描绘了一幅江乡雪景图，塑造了渔翁的形象。诗中运用典型概括的手法，选择千山万径，人鸟绝迹这种最能表现山野严寒的景物，描绘大雪纷飞，天寒地冻的图景。',
 '冬天', '中等'),

('悯农', 1, 1, '诗',
 '["锄禾日当午，汗滴禾下土。", "谁知盘中餐，粒粒皆辛苦。"]',
 '锄禾日当午，汗滴禾下土。\n谁知盘中餐，粒粒皆辛苦。',
 '这首诗反映了农民辛勤劳动的情景，表达了珍惜粮食的思想。诗中通过具体的劳动场景，生动地描绘了农民在烈日下辛勤耕作的情景。',
 '劳动', '简单'),

('水调歌头·明月几时有', 6, 2, '词',
 '["明月几时有？把酒问青天。", "不知天上宫阙，今夕是何年。"]',
 '明月几时有？把酒问青天。\n不知天上宫阙，今夕是何年。\n我欲乘风归去，又恐琼楼玉宇，高处不胜寒。\n起舞弄清影，何似在人间。',
 '此词是中秋望月怀人之作，表达了对胞弟苏辙的无限怀念。词人运用形象描绘手法，勾勒出一种皓月当空、亲人千里、孤高旷远的境界氛围。',
 '月亮', '困难'),

('声声慢·寻寻觅觅', 7, 2, '词',
 '["寻寻觅觅，冷冷清清，凄凄惨惨戚戚。", "乍暖还寒时候，最难将息。"]',
 '寻寻觅觅，冷冷清清，凄凄惨惨戚戚。\n乍暖还寒时候，最难将息。\n三杯两盏淡酒，怎敌他、晚来风急？\n雁过也，正伤心，却是旧时相识。',
 '这首词通过描写残秋所见、所闻、所感，抒发自己因国破家亡、天涯沦落而产生的孤寂落寞、悲凉愁苦的心绪，具有浓厚的时代色彩。',
 '忧伤', '困难');

-- 插入诗词标签关联数据
INSERT INTO poem_tags (poem_id, tag_id) VALUES
(1, 1), (1, 2),  -- 静夜思：思乡、月亮
(2, 3), (2, 4),  -- 春晓：春天、自然
(3, 8), (3, 6),  -- 登鹳雀楼：豪放、边塞
(4, 5), (4, 1),  -- 相思：爱情、思乡
(5, 4), (5, 7),  -- 江雪：自然、山水
(6, 4),          -- 悯农：自然
(7, 2), (7, 8),  -- 水调歌头：月亮、豪放
(8, 9), (8, 5);  -- 声声慢：婉约、爱情

-- 插入示例用户数据
INSERT INTO users (username, email, password_hash, bio, role) VALUES
('admin', 'admin@poem.com', '$2b$10$examplehash', '网站管理员', 'admin'),
('诗词爱好者', 'user1@poem.com', '$2b$10$examplehash', '热爱古典诗词的普通用户', 'user'),
('文学研究者', 'researcher@poem.com', '$2b$10$examplehash', '专注于古典文学研究', 'user');

-- 插入用户收藏数据
INSERT INTO user_favorites (user_id, poem_id) VALUES
(2, 1), (2, 3), (2, 5),  -- 用户1收藏静夜思、登鹳雀楼、江雪
(3, 2), (3, 4), (3, 7);  -- 用户2收藏春晓、相思、水调歌头

-- 插入评论数据
INSERT INTO comments (user_id, poem_id, content, rating, like_count) VALUES
(2, 1, '这首诗让我想起了远方的家乡，每次读都很有感触。', 5, 12),
(3, 1, '李白的静夜思真是千古绝唱，简单的语言表达深刻的情感。', 5, 8),
(2, 2, '孟浩然的春晓描绘了春天的美好，语言清新自然。', 4, 5),
(3, 7, '苏轼的水调歌头意境深远，不愧是中秋词的巅峰之作。', 5, 15);

-- 插入浏览历史数据
INSERT INTO view_history (user_id, poem_id, view_count) VALUES
(2, 1, 5), (2, 2, 3), (2, 3, 2),
(3, 1, 8), (3, 7, 6), (3, 4, 4);

COMMIT;

-- 查询验证数据
SELECT '诗词数据统计:' AS info;
SELECT COUNT(*) as poem_count FROM poems;

SELECT '诗人数据统计:' AS info;  
SELECT p.name as poet_name, d.name as dynasty, COUNT(po.id) as poem_count
FROM poets p 
LEFT JOIN poems po ON p.id = po.poet_id 
JOIN dynasties d ON p.dynasty_id = d.id
GROUP BY p.id, p.name, d.name
ORDER BY poem_count DESC;

SELECT '热门诗词排行:' AS info;
SELECT po.title, p.name as author, d.name as dynasty, po.view_count
FROM poems po
JOIN poets p ON po.poet_id = p.id
JOIN dynasties d ON po.dynasty_id = d.id
ORDER BY po.view_count DESC
LIMIT 5;